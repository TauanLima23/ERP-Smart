SELECT PAC.PAC_REG,
       PAC.PAC_NOME,
       'Magnésio Sérico' as EXAME,
       SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30156, 01)/1000 AS RESULTADO,
       RCL.RCL_DTHR
FROM RCL 
     INNER JOIN PAC ON (RCL.RCL_PAC = PAC.PAC_REG)
WHERE RCL.RCL_COD IN ('3858') AND
RCL.RCL_DTHR >=  to_date ( '2024-10-01 00:00:00', 'yyyy-mm-dd hh24:mi:ss' ) AND
RCL.RCL_DTHR <=  to_date ( '2024-10-10 00:00:00', 'yyyy-mm-dd hh24:mi:ss' )  AND
SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30156, 01) <> '?'

UNION ALL

SELECT PAC.PAC_REG,
       PAC.PAC_NOME,
       'Sódio Sérico' as EXAME,
       SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30163, 01)/1000 AS RESULTADO,
       RCL.RCL_DTHR
FROM RCL 
     INNER JOIN PAC ON (RCL.RCL_PAC = PAC.PAC_REG)
WHERE RCL.RCL_COD IN ('3873') AND
RCL.RCL_DTHR >=  to_date ( '2024-10-01 00:00:00', 'yyyy-mm-dd hh24:mi:ss' ) AND
RCL.RCL_DTHR <=  to_date ( '2024-10-10 00:00:00', 'yyyy-mm-dd hh24:mi:ss' )  AND
SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30163, 01) <> '?'

UNION ALL

SELECT PAC.PAC_REG,
       PAC.PAC_NOME,
       'Potássio Sérico' as EXAME,
       SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30159, 01)/1000 AS RESULTADO,
       RCL.RCL_DTHR
FROM RCL 
     INNER JOIN PAC ON (RCL.RCL_PAC = PAC.PAC_REG)
WHERE RCL.RCL_COD IN ('3867') AND
RCL.RCL_DTHR >=  to_date ( '2024-09-01 00:00:00', 'yyyy-mm-dd hh24:mi:ss' ) AND
RCL.RCL_DTHR <=  to_date ( '2024-09-10 00:00:00', 'yyyy-mm-dd hh24:mi:ss' )  AND
SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30159, 01) <> '?'

UNION ALL

SELECT PAC.PAC_REG,
       PAC.PAC_NOME,
       'Creatinina Sérico' as EXAME,
       SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30145, 01)/1000 AS RESULTADO,
       RCL.RCL_DTHR
FROM RCL 
     INNER JOIN PAC ON (RCL.RCL_PAC = PAC.PAC_REG)
WHERE RCL.RCL_COD IN ('3801') AND
RCL.RCL_DTHR >=  to_date ( '2024-09-01 00:00:00', 'yyyy-mm-dd hh24:mi:ss' ) AND
RCL.RCL_DTHR <=  to_date ( '2024-09-10 00:00:00', 'yyyy-mm-dd hh24:mi:ss' )  AND
SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30145, 01) <> '?'

UNION ALL

SELECT PAC.PAC_REG,
       PAC.PAC_NOME,
       'Ureia Sérico' as EXAME,
       SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30112, 01)/1000 AS RESULTADO,
       RCL.RCL_DTHR
FROM RCL 
     INNER JOIN PAC ON (RCL.RCL_PAC = PAC.PAC_REG)
WHERE RCL.RCL_COD IN ('3888') AND
RCL.RCL_DTHR >=  to_date ( '2024-09-01 00:00:00', 'yyyy-mm-dd hh24:mi:ss' ) AND
RCL.RCL_DTHR <=  to_date ( '2024-09-10 00:00:00', 'yyyy-mm-dd hh24:mi:ss' )  AND
SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30112, 01) <> '?'

UNION ALL

SELECT PAC.PAC_REG,
       PAC.PAC_NOME,
       'Ureia Sérico' as EXAME,
       SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30112, 01)/1000 AS RESULTADO,
       RCL.RCL_DTHR
FROM RCL 
     INNER JOIN PAC ON (RCL.RCL_PAC = PAC.PAC_REG)
WHERE RCL.RCL_COD IN ('3888') AND
RCL.RCL_DTHR >=  to_date ( '2024-09-01 00:00:00', 'yyyy-mm-dd hh24:mi:ss' ) AND
RCL.RCL_DTHR <=  to_date ( '2024-09-10 00:00:00', 'yyyy-mm-dd hh24:mi:ss' )  AND
SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30112, 01) <> '?'

UNION ALL 

SELECT PAC.PAC_REG,
       PAC.PAC_NOME,
       '' as EXAME,
       SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30112, 01)/1000 AS RESULTADO,
       RCL.RCL_DTHR
FROM RCL 
     INNER JOIN PAC ON (RCL.RCL_PAC = PAC.PAC_REG)
WHERE RCL.RCL_COD IN ('3888') AND
RCL.RCL_DTHR >=  to_date ( '2024-09-01 00:00:00', 'yyyy-mm-dd hh24:mi:ss' ) AND
RCL.RCL_DTHR <=  to_date ( '2024-09-10 00:00:00', 'yyyy-mm-dd hh24:mi:ss' )  AND
SMART.F_RESULTADO_RCL_2(RCL.RCL_TXT, 30112, 01) <> '?'


